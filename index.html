<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Choose your own Adventure</title>
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/bootstrap-theme.css">
</head>
<body>
  <script src="js/libs/jquery-1.9.1.js"></script>
  <script src="js/libs/handlebars-1.0.0.js"></script>
  <script src="js/libs/ember-1.0.0.js"></script>
  <script src="js/libs/ember-data.js"></script>
  <script src="js/libs/bootstrap.js"></script>
  <script src="js/app.js"></script>
  <script src="js/routes.js"></script>
  <script src="js/controllers.js"></script>
  <script src="js/models.js"></script>
  <script src="js/fixtures.js"></script>

  <script type="text/x-handlebars">
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="navbar-header">
        <a class="navbar-brand" href="#">Choose your own Adventure</a>
      </div>
    </nav>
    {{outlet}}
  </script>

  <script type="text/x-handlebars" data-template-name="stories/index">
    <h3>Stories:</h3>
    <ul>
      {{#each story in content}}
        <li>
        {{#link-to 'story.edit' story}}
          <button class="btn btn-primary btn-xs">Edit</button>
        {{/link-to}}
        {{#link-to 'story' story}}{{story.title}}{{/link-to}}
        </li>
      {{/each}}
    </ul>
  </script>

  <script type="text/x-handlebars" data-template-name="story">
    {{#link-to 'story.edit' content}}
      <button class="btn btn-primary">Edit</button>
    {{/link-to}}
    <h3>{{title}}</h3>
    {{outlet}}
  </script>

  <script type="text/x-handlebars" data-template-name="story/index">
    {{render section-show first_section}}
  </script>

  <script type="text/x-handlebars" data-template-name="story/edit/index">
    {{ render section-edit first_section }}
  </script>

  <script type="text/x-handlebars" data-template-name="story/edit">
    <button {{action save}} class="btn btn-success">Save</button>
    <button {{action cancel}} class="btn btn-danger">Cancel</button>
    <h3>Edit {{title}}</h3>

    <fieldset>
      <label>Title</label>
      {{input value=title}}
    </fieldset>
    {{ outlet }}
  </script>

  <script type="text/x-handlebars" data-template-name="story/section">
    {{render section-show content}}
  </script>

  <script type="text/x-handlebars" data-template-name="story/edit/section">
    {{render section-edit content}}
  </script>

  <script type="text/x-handlebars" data-template-name="section-show">
    {{content.text}}
    <br>
    <br>
    {{#if content.choices}}
      <p>What do you want to do?<p>
      <ul>
        {{#each content.choices}}
          <li>{{#link-to 'story.section' goes_to}}{{wording}}{{/link-to}}</li>
        {{/each}}
      </ul>
    {{else}}
      <p><strong>The End</strong></p>
    {{/if}}
  </script>

  <script type="text/x-handlebars" data-template-name="section-edit">
    <h4>Section: {{content.synopsis}}</h4>
    <div>
      <fieldset>
        <label>Short synopsis:</label>
        {{input value=content.synopsis}}
      </fieldset>
      <fieldset>
        <label>Content:</label><br>
        {{textarea value=content.text cols=100 rows=6}}
      </fieldset>
      {{render choices-edit content.choices}}
    </div>
  </script>

  <script type="text/x-handlebars" data-template-name="choices-edit">
    <h4>Choices:</h4>
    <ul>
    {{#each choice in content}}
      <li>
        <button {{action "remove" choice}} class="btn btn-danger btn-xs">Remove</button>
        {{#link-to 'story.edit.section' choice.goes_to}}{{choice.wording}}{{/link-to}}
      </li>
    {{/each}}
    </ul>
    {{render "choice-add"}}
  </script>

  <script type="text/x-handlebars" data-template-name="choice-add">
    <label>New choice</label><br>

    {{input value=wording placeholder="Add an extra choice here" size="60"}}
    Links to:
    {{view Ember.Select
        contentBinding="storySections"
        optionValuePath="content"
        optionLabelPath="content.synopsis"
        valueBinding="goes_to"
    }}
    <button {{action "add"}} class="btn btn-success btn-xs">Add</button>
  </script>
</body>
</html>
